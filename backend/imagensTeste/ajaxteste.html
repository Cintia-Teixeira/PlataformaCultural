<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
</head>

<body>
    <h1>TESTE</h1>
    <form name="saveImage" action="http://localhost:4000/save-image" method="post" enctype="multipart/form-data">
        <input type="number" name="id" placeholder="Id..." />
        <input type="file" name="image" placeholder="Image..." />
        <button type='submit'>Salvar</button>
    </form>
    <div id='teste'>MÃ¡ Oe</div>
</body>
<script>
    document.getElementsByName("saveImage").onsubmit = async e => {
        e.preventDefault()
        const form = e.target
        const data = new FormData(form)
        const options = {
            method: form.method,
            body: new URLSearchParams(data)
        }
        console.log(JSON.stringify(options))

        // fetch(form.action, options)
        //     .then(res => res.json())
        //     .then(json => {
        //         const resultado = document.getElementById('teste')
        //         resultado.innerHTML = JSON.stringify(json)
        //     })
        try {
            const resp = await fetch(form.action, options)
            const json = await resp.json()
            resultado.innerHTML = JSON.stringify(json)
        } catch (e) {
            resultado.innerHTML = e
        }
    }
</script>

</html>